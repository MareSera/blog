---
const links = [
  { path: "/", name: "首页", icon: "icon-home" },
  { path: "/posts", name: "文集", icon: "icon-book" },
  { path: "/friends", name: "友邻", icon: "icon-users" },
  { path: "/moments", name: "絮语", icon: "icon-chat" },
  { path: "/about", name: "吾志", icon: "icon-user" }
];
---

<nav class="sticky top-0 bg-surface/80 backdrop-blur z-50 border-b">
  <div class="max-w-6xl mx-auto px-4">
    <div class="flex items-center justify-between h-16">
      <!-- 左侧品牌 -->
      <a href="/" class="text-xl font-serif font-bold hover:text-accent transition-colors">
        MareSera
      </a>

      <!-- 右侧容器 -->
      <div class="flex items-center gap-6">
        <!-- 导航菜单 -->
        <div class="hidden md:flex items-center gap-6">
          {links.map(link => (
            <a 
              href={link.path}
              class="flex items-center gap-1 hover:text-accent transition-colors"
              class:list={[{
                'text-accent': Astro.url.pathname === link.path
              }]}
            >
              <i class={`iconfont ${link.icon} text-lg`} />
              <span>{link.name}</span>
            </a>
          ))}
        </div>

        <!-- 胶囊开关 -->
        <button
          id="theme-toggle"
          class="relative w-14 h-8 rounded-full bg-gray-200 dark:bg-gray-700 transition-colors"
          aria-label="昼夜切换"
        >
          <div id="theme-thumb" class="
            absolute top-1 w-6 h-6 bg-white dark:bg-gray-300 rounded-full shadow-lg
            transition-all duration-300
            left-1 dark:left-7
          ">
            <i id="theme-icon" class="
              absolute inset-0 flex items-center justify-center
              iconfont text-sm
              text-yellow-500 dark:text-gray-800
              transition-opacity
              opacity-100 dark:opacity-0
            ">☀️</i>
            <i class="
              absolute inset-0 flex items-center justify-center
              iconfont text-sm
              text-gray-800 dark:text-yellow-400
              transition-opacity
              opacity-0 dark:opacity-100
            ">🌙</i>
          </div>
        </button>
      </div>
    </div>
  </div>
</nav>

<script>
  // 初始化主题
  const initTheme = () => {
    const savedTheme = localStorage.getItem('theme') || 
      (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    document.documentElement.classList.toggle('dark', savedTheme === 'dark');
  };

  // 切换主题
  document.getElementById('theme-toggle').addEventListener('click', () => {
    const isDark = document.documentElement.classList.toggle('dark');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  });

  initTheme();
</script>
